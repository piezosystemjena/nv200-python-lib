

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SPI Controller Box &mdash; NV200 Python Library</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5349f25f" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="_static/style_override_css/style_override.css?v=6a36a437" />
      <link rel="stylesheet" type="text/css" href="_static/style_override_css/color_roles.css?v=7881a399" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/dark.css?v=70edf1c7" />

  
    <link rel="shortcut icon" href="_static/favicon.png"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
      <script src="_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api.html" />
    <link rel="prev" title="Resonance Measurement" href="analysis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            NV200 Python Library
              <img src="_static/piezosystem_logo_white.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="connecting.html">Connecting to device</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started with the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid_and_filters.html">PID Controller and Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_recorder.html">Data Recorder</a></li>
<li class="toctree-l1"><a class="reference internal" href="trigger_io.html">Trigger In and Trigger Out</a></li>
<li class="toctree-l1"><a class="reference internal" href="waveform_generator.html">Waveform Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Resonance Measurement</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SPI Controller Box</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#step-by-step-guide-to-using-the-spi-controller-box-with-the-nv200-library">Step by step guide to using the SPI Controller Box with the NV200 library</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Step by step guide to using the SPI Controller Box with the NV200 library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-import-the-required-modules">Step 1: Import the required modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-discover-available-spi-box-devices">Step 2: Discover available SPI Box devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-connect-to-a-detected-device">Step 3: Connect to a detected device</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-simple-setpoint-commands-move-channels">Step 4: Simple setpoint commands (move channels)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-5-create-waveforms-generator-usage">Step 5: Create waveforms (generator usage)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-6-transfer-waveforms-to-the-spi-box">Step 6: Transfer waveforms to the SPI Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-7-start-and-wait-for-waveform-playback">Step 7: Start and wait for waveform playback</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-8-read-back-spi-response-data-recorded-samples">Step 8: Read back SPI response data (recorded samples)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-9-plotting-and-visualization">Step 9: Plotting and visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-10-close-the-device">Step 10: Close the device</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extra-notes-and-implementation-details">Extra notes and implementation details</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nv200.spibox_device">API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice"><code class="docutils literal notranslate"><span class="pre">SpiBoxDevice</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.WaveformState"><code class="docutils literal notranslate"><span class="pre">WaveformState</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.await_waveform_completion"><code class="docutils literal notranslate"><span class="pre">await_waveform_completion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.connect"><code class="docutils literal notranslate"><span class="pre">connect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_response_sample"><code class="docutils literal notranslate"><span class="pre">get_response_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_response_samples_count"><code class="docutils literal notranslate"><span class="pre">get_response_samples_count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_setpoints_percent"><code class="docutils literal notranslate"><span class="pre">get_setpoints_percent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_cycles"><code class="docutils literal notranslate"><span class="pre">get_waveform_cycles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_response"><code class="docutils literal notranslate"><span class="pre">get_waveform_response()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_sample_factors"><code class="docutils literal notranslate"><span class="pre">get_waveform_sample_factors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_status"><code class="docutils literal notranslate"><span class="pre">get_waveform_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.set_setpoints_percent"><code class="docutils literal notranslate"><span class="pre">set_setpoints_percent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.set_waveform_cycles"><code class="docutils literal notranslate"><span class="pre">set_waveform_cycles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.set_waveform_sample_factors"><code class="docutils literal notranslate"><span class="pre">set_waveform_sample_factors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.set_waveform_samples"><code class="docutils literal notranslate"><span class="pre">set_waveform_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.start_waveforms"><code class="docutils literal notranslate"><span class="pre">start_waveforms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.stop_waveforms"><code class="docutils literal notranslate"><span class="pre">stop_waveforms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.upload_waveform_samples"><code class="docutils literal notranslate"><span class="pre">upload_waveform_samples()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nv200.spibox_device.parse_hex_to_floats_percent"><code class="docutils literal notranslate"><span class="pre">parse_hex_to_floats_percent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nv200.spibox_device.percent_to_hex"><code class="docutils literal notranslate"><span class="pre">percent_to_hex()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NV200 Python Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">SPI Controller Box</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spi-controller-box">
<h1>SPI Controller Box<a class="headerlink" href="#spi-controller-box" title="Link to this heading"></a></h1>
<p>To synchronously control multiple NV200 devices, the SPI Box can be used as a master device.
It can send positional data to up to 3 connected NV200 devices via SPI communication.</p>
<p>Due to the NV200’s SPI limitations, the SPI Box can only send position commands to the connected devices.
Therefore configuration of the connected NV200 devices (e.g., PID parameters, operation mode, etc.) must be done separately.</p>
<p>The SPI Box provides the following functionality:
- Sending single position commands to up to 3 connected NV200 devices
- Replaying a custom waveform with up to 20000 samples
- Reading back the SPI data received from the connected NV200 devices
- Ethernet, USB and RS-232 connection support</p>
<p>The following example demonstrates how to use these features of the SPI Controller Box.</p>
<section id="step-by-step-guide-to-using-the-spi-controller-box-with-the-nv200-library">
<h2>Step by step guide to using the SPI Controller Box with the NV200 library<a class="headerlink" href="#step-by-step-guide-to-using-the-spi-controller-box-with-the-nv200-library" title="Link to this heading"></a></h2>
<p>This guide walks through the typical steps required to control the SPI Controller Box
(<a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice" title="nv200.spibox_device.SpiBoxDevice"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SpiBoxDevice</span></code></a>) using the NV200 Python library and shows how to discover/connect to the device, set simple
setpoints, upload and run waveforms, and read back the SPI response data.</p>
</section>
<section id="id1">
<h2>Step by step guide to using the SPI Controller Box with the NV200 library<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<section id="step-1-import-the-required-modules">
<h3>Step 1: Import the required modules<a class="headerlink" href="#step-1-import-the-required-modules" title="Link to this heading"></a></h3>
<p>Start by importing the required modules seen in the example above.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib_helpers</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nv200.connection_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">connect_to_detected_device</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nv200.device_discovery</span><span class="w"> </span><span class="kn">import</span> <span class="n">discover_devices</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nv200.shared_types</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiscoverFlags</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nv200.spibox_device</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpiBoxDevice</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nv200.waveform_generator</span><span class="w"> </span><span class="kn">import</span> <span class="n">WaveformGenerator</span><span class="p">,</span> <span class="n">WaveformType</span>
</pre></div>
</div>
</section>
<section id="step-2-discover-available-spi-box-devices">
<h3>Step 2: Discover available SPI Box devices<a class="headerlink" href="#step-2-discover-available-spi-box-devices" title="Link to this heading"></a></h3>
<p>Discover devices connected via the interfaces you want to use.
In this example, we search for SPI Controller Boxes connected via USB using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">detected_devices</span> <span class="o">=</span> <span class="k">await</span> <span class="n">discover_devices</span><span class="p">(</span>
    <span class="n">DiscoverFlags</span><span class="o">.</span><span class="n">DETECT_SERIAL</span> <span class="o">|</span> <span class="n">DiscoverFlags</span><span class="o">.</span><span class="n">READ_DEVICE_INFO</span><span class="p">,</span>
    <span class="n">device_class</span><span class="o">=</span><span class="n">SpiBoxDevice</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-3-connect-to-a-detected-device">
<h3>Step 3: Connect to a detected device<a class="headerlink" href="#step-3-connect-to-a-detected-device" title="Link to this heading"></a></h3>
<p>After discovery, connect to a device using the helper from <a class="reference internal" href="api.html#module-nv200.connection_utils"><span class="std std-ref">connection_utils</span></a>. In this case we connect to the first detected device:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="p">:</span> <span class="n">SpiBoxDevice</span> <span class="o">=</span> <span class="k">await</span> <span class="n">connect_to_detected_device</span><span class="p">(</span><span class="n">detected_devices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="step-4-simple-setpoint-commands-move-channels">
<h3>Step 4: Simple setpoint commands (move channels)<a class="headerlink" href="#step-4-simple-setpoint-commands-move-channels" title="Link to this heading"></a></h3>
<p>The SPI Box can only send position commands to connected NV200 devices. Use the <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice" title="nv200.spibox_device.SpiBoxDevice"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SpiBoxDevice</span></code></a>’s high-level set/get
helpers to move channels and read back positions. The example moves all channels to lowest and highest setpoints
and reads them back using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">set_setpoints_percent</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">set_setpoints_percent</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
<span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">positions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">get_setpoints_percent</span><span class="p">()</span>
</pre></div>
</div>
<p>Note: setpoints are provided as percentages (0.0–100.0). The <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice" title="nv200.spibox_device.SpiBoxDevice"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SpiBoxDevice</span></code></a> converts these to the NV200 16-bit
hex representation internally.</p>
</section>
<section id="step-5-create-waveforms-generator-usage">
<h3>Step 5: Create waveforms (generator usage)<a class="headerlink" href="#step-5-create-waveforms-generator-usage" title="Link to this heading"></a></h3>
<p>To replay synchronized motion patterns, create a <a class="reference internal" href="api.html#nv200.waveform_generator.WaveformGenerator" title="nv200.waveform_generator.WaveformGenerator"><code class="xref any py py-class docutils literal notranslate"><span class="pre">WaveformGenerator</span></code></a> instance. The example creates the generator with
<code class="xref any docutils literal notranslate"><span class="pre">None</span></code> as the device because the SPI Box is not a standard <a class="reference internal" href="api.html#nv200.nv200_device.NV200Device" title="nv200.nv200_device.NV200Device"><code class="xref any py py-class docutils literal notranslate"><span class="pre">NV200Device</span></code></a> and the generator is only used to create
sample arrays. We then generate three sine waveforms (one per channel) in a loop with <code class="xref any docutils literal notranslate"><span class="pre">generate_waveform(...)</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">waveform_generator</span> <span class="o">=</span> <span class="n">WaveformGenerator</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">waveforms</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Generate a sine waveforms for all channels</span>
<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">waveform</span> <span class="o">=</span> <span class="n">waveform_generator</span><span class="o">.</span><span class="n">generate_waveform</span><span class="p">(</span>
        <span class="n">waveform_type</span><span class="o">=</span><span class="n">WaveformType</span><span class="o">.</span><span class="n">SINE</span><span class="p">,</span>
        <span class="n">freq_hz</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">low_level</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">high_level</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
        <span class="n">phase_shift_rad</span><span class="o">=</span> <span class="n">ch</span> <span class="o">*</span> <span class="p">(</span><span class="mf">3.14159</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># Phase shift each channel by 90 degrees</span>
    <span class="p">)</span>

    <span class="n">waveforms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">waveform</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-6-transfer-waveforms-to-the-spi-box">
<h3>Step 6: Transfer waveforms to the SPI Box<a class="headerlink" href="#step-6-transfer-waveforms-to-the-spi-box" title="Link to this heading"></a></h3>
<p>Before uploading samples, configure how often the waveforms should repeat and at what sampling rate they should be played back:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">set_waveform_cycles</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">set_waveform_sample_factors</span><span class="p">(</span>
    <span class="n">waveforms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sample_factor</span><span class="p">,</span>
    <span class="n">waveforms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sample_factor</span><span class="p">,</span>
    <span class="n">waveforms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sample_factor</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Upload the prepared sample arrays with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">upload_waveform_samples</span><span class="p">(</span>
    <span class="n">waveforms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">waveforms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">waveforms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">current</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upload progress: </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-7-start-and-wait-for-waveform-playback">
<h3>Step 7: Start and wait for waveform playback<a class="headerlink" href="#step-7-start-and-wait-for-waveform-playback" title="Link to this heading"></a></h3>
<p>Start waveform playback on the device with <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.start_waveforms" title="nv200.spibox_device.SpiBoxDevice.start_waveforms"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">start_waveforms()</span></code></a> and wait for completion with
<a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.await_waveform_completion" title="nv200.spibox_device.SpiBoxDevice.await_waveform_completion"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">await_waveform_completion()</span></code></a> as shown in the example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">start_waveforms</span><span class="p">()</span>
<span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">await_waveform_completion</span><span class="p">()</span>
</pre></div>
</div>
<p>Call <code class="xref any docutils literal notranslate"><span class="pre">await</span> <span class="pre">device.stop_waveforms()</span></code> if you need to stop playback early.</p>
</section>
<section id="step-8-read-back-spi-response-data-recorded-samples">
<h3>Step 8: Read back SPI response data (recorded samples)<a class="headerlink" href="#step-8-read-back-spi-response-data-recorded-samples" title="Link to this heading"></a></h3>
<p>Read the SPI response buffer using <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_response" title="nv200.spibox_device.SpiBoxDevice.get_waveform_response"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_waveform_response</span></code></a>. The example reads every 3rd sample (step size 3) and
limits to 1000 max samples while reporting progress:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">get_waveform_response</span><span class="p">(</span>
    <span class="mi">3</span><span class="p">,</span>
    <span class="mi">1000</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">current</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Readback progress: </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The returned items are <a class="reference internal" href="api.html#nv200.waveform_generator.WaveformGenerator.WaveformData" title="nv200.waveform_generator.WaveformGenerator.WaveformData"><code class="xref any py py-class docutils literal notranslate"><span class="pre">WaveformGenerator.WaveformData</span></code></a> objects which contain <a class="reference internal" href="api.html#nv200.shared_types.TimeSeries.values" title="nv200.shared_types.TimeSeries.values"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">values</span></code></a> and <a class="reference internal" href="api.html#nv200.shared_types.TimeSeries.sample_time_ms" title="nv200.shared_types.TimeSeries.sample_time_ms"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">sample_time_ms</span></code></a>.</p>
</section>
<section id="step-9-plotting-and-visualization">
<h3>Step 9: Plotting and visualization<a class="headerlink" href="#step-9-plotting-and-visualization" title="Link to this heading"></a></h3>
<p>Use the included <code class="xref any docutils literal notranslate"><span class="pre">matplotlib_helpers</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">matplotlib</span></code> to plot response channels as in the example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matplotlib_helpers</span><span class="o">.</span><span class="n">prepare_plot_style</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sample_times_ms</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Channel 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sample_times_ms</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Channel 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sample_times_ms</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Channel 3&#39;</span><span class="p">)</span>
<span class="n">matplotlib_helpers</span><span class="o">.</span><span class="n">show_plot</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="step-10-close-the-device">
<h3>Step 10: Close the device<a class="headerlink" href="#step-10-close-the-device" title="Link to this heading"></a></h3>
<p>When finished, close the device transport to release resources:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">device</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="extra-notes-and-implementation-details">
<h3>Extra notes and implementation details<a class="headerlink" href="#extra-notes-and-implementation-details" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice" title="nv200.spibox_device.SpiBoxDevice"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SpiBoxDevice</span></code></a> exposes convenience methods that map to low-level SPI Box commands:
- <code class="xref any docutils literal notranslate"><span class="pre">set_waveform_sample_factors(...)</span></code> / <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_sample_factors" title="nv200.spibox_device.SpiBoxDevice.get_waveform_sample_factors"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_waveform_sample_factors()</span></code></a>
- <code class="xref any docutils literal notranslate"><span class="pre">set_waveform_cycles(...)</span></code> / <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_cycles" title="nv200.spibox_device.SpiBoxDevice.get_waveform_cycles"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_waveform_cycles()</span></code></a>
- <code class="xref any docutils literal notranslate"><span class="pre">upload_waveform_samples(...)</span></code>, which sets sample counts and issues <code class="xref any docutils literal notranslate"><span class="pre">wfset</span></code> entries for every sample
- <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.start_waveforms" title="nv200.spibox_device.SpiBoxDevice.start_waveforms"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">start_waveforms()</span></code></a> / <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.stop_waveforms" title="nv200.spibox_device.SpiBoxDevice.stop_waveforms"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">stop_waveforms()</span></code></a> which control <code class="xref any docutils literal notranslate"><span class="pre">wfrun</span></code>
- <code class="xref any docutils literal notranslate"><span class="pre">get_waveform_response(...)</span></code>, <a class="reference internal" href="#nv200.spibox_device.SpiBoxDevice.get_response_samples_count" title="nv200.spibox_device.SpiBoxDevice.get_response_samples_count"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_response_samples_count()</span></code></a> and <code class="xref any docutils literal notranslate"><span class="pre">get_response_sample(index)</span></code> for readback</p></li>
<li><p>Keep in mind the SPI Box can only send position commands; device configuration (PID, mode, etc.) must be
applied to the NV200 devices separately using their own configuration flows.</p></li>
</ul>
</section>
</section>
<section id="module-nv200.spibox_device">
<span id="api-reference"></span><h2>API Reference<a class="headerlink" href="#module-nv200.spibox_device" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SpiBoxDevice</span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api.html#nv200.device_base.PiezoDeviceBase" title="nv200.device_base.PiezoDeviceBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">PiezoDeviceBase</span></code></a></p>
<p>A high-level asynchronous client for communicating with NV200 piezo controllers.
This class extends the <a class="reference internal" href="api.html#nv200.device_base.PiezoDeviceBase" title="nv200.device_base.PiezoDeviceBase"><code class="xref any py py-class docutils literal notranslate"><span class="pre">PiezoDeviceBase</span></code></a> base class and provides high-level methods
for setting and getting various device parameters, such as PID mode, setpoint,</p>
<dl class="py class">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.WaveformState">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WaveformState</span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.WaveformState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.WaveformState" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transport</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.await_waveform_completion">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">await_waveform_completion</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.await_waveform_completion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.await_waveform_completion" title="Link to this definition"></a></dt>
<dd><p>Waits until the waveform has completed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.connect">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auto_adjust_comm_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.connect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.connect" title="Link to this definition"></a></dt>
<dd><p>Establishes a connection using the transport layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.get_response_sample">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_response_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.get_response_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.get_response_sample" title="Link to this definition"></a></dt>
<dd><p>Get a single response sample at the specified index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) – The index of the sample to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing the waveform data for each channel at the specified index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.get_response_samples_count">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_response_samples_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.get_response_samples_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.get_response_samples_count" title="Link to this definition"></a></dt>
<dd><p>Get the number of available response samples from the device.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of available response samples.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.get_setpoints_percent">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_setpoints_percent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.get_setpoints_percent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.get_setpoints_percent" title="Link to this definition"></a></dt>
<dd><p>Get device setpoints as percentages (0.0 to 100.0) for 3 channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list containing the setpoints for each channel as percentages.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.get_waveform_cycles">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_waveform_cycles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.get_waveform_cycles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_cycles" title="Link to this definition"></a></dt>
<dd><p>Get the number of waveform cycles for each channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list containing the number of cycles for each channel.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.get_waveform_response">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_waveform_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_progress</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="api.html#nv200.waveform_generator.WaveformGenerator.WaveformData" title="nv200.waveform_generator.WaveformGenerator.WaveformData"><span class="pre">WaveformData</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.get_waveform_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_response" title="Link to this definition"></a></dt>
<dd><p>Get the current waveform response from the device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_size</strong> (<em>int</em>) – The step size for sampling the waveform response.</p></li>
<li><p><strong>max_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of samples to retrieve. If None, retrieves all available samples.</p></li>
<li><p><strong>on_progress</strong> (<em>callable</em><em>, </em><em>optional</em>) – A callback function that receives progress updates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing three numpy arrays, one for each channel, with the waveform data.
If no samples are available, returns None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.get_waveform_sample_factors">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_waveform_sample_factors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.get_waveform_sample_factors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_sample_factors" title="Link to this definition"></a></dt>
<dd><p>Get the waveform sample factors for each channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list containing the sample factors for each channel.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.get_waveform_status">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_waveform_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.get_waveform_status"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.get_waveform_status" title="Link to this definition"></a></dt>
<dd><p>Get the current waveform status.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.set_setpoints_percent">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_setpoints_percent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ch1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.set_setpoints_percent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.set_setpoints_percent" title="Link to this definition"></a></dt>
<dd><p>Set device setpoints as percentages (0.0 to 100.0) for 3 channels.</p>
<p>Converts percent values to 16-bit hex strings and sends them as a formatted command.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ch1</strong> (<em>float</em>) – Setpoint for channel 1 (0.0 to 100.0).</p></li>
<li><p><strong>ch2</strong> (<em>float</em>) – Setpoint for channel 2 (0.0 to 100.0).</p></li>
<li><p><strong>ch3</strong> (<em>float</em>) – Setpoint for channel 3 (0.0 to 100.0).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.set_waveform_cycles">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_waveform_cycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ch1_cycles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch2_cycles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch3_cycles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.set_waveform_cycles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.set_waveform_cycles" title="Link to this definition"></a></dt>
<dd><p>Set the number of waveform cycles for each channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ch1_cycles</strong> (<em>int</em>) – Number of cycles for channel 1.</p></li>
<li><p><strong>ch2_cycles</strong> (<em>int</em>) – Number of cycles for channel 2.</p></li>
<li><p><strong>ch3_cycles</strong> (<em>int</em>) – Number of cycles for channel 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.set_waveform_sample_factors">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_waveform_sample_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ch1_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch2_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch3_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.set_waveform_sample_factors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.set_waveform_sample_factors" title="Link to this definition"></a></dt>
<dd><p>Set the waveform sample factors for each channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ch1_factor</strong> (<em>int</em>) – Sample factor for channel 1.</p></li>
<li><p><strong>ch2_factor</strong> (<em>int</em>) – Sample factor for channel 2.</p></li>
<li><p><strong>ch3_factor</strong> (<em>int</em>) – Sample factor for channel 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.set_waveform_samples">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_waveform_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ch1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_progress</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.set_waveform_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.set_waveform_samples" title="Link to this definition"></a></dt>
<dd><p>Add waveform samples for each channel.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.start_waveforms">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">start_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.start_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.start_waveforms" title="Link to this definition"></a></dt>
<dd><p>Start the waveform playback.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.stop_waveforms">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stop_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.stop_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.stop_waveforms" title="Link to this definition"></a></dt>
<dd><p>Stop any running waveforms on the device.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nv200.spibox_device.SpiBoxDevice.upload_waveform_samples">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">upload_waveform_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ch1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_progress</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nv200/spibox_device.html#SpiBoxDevice.upload_waveform_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.SpiBoxDevice.upload_waveform_samples" title="Link to this definition"></a></dt>
<dd><p>Upload waveform samples for each channel.</p>
<p>Uploads the samples to the device after setting the sample counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ch1</strong> (<em>np.ndarray</em>) – Waveform samples for channel 1.</p></li>
<li><p><strong>ch2</strong> (<em>np.ndarray</em>) – Waveform samples for channel 2.</p></li>
<li><p><strong>ch3</strong> (<em>np.ndarray</em>) – Waveform samples for channel 3.</p></li>
<li><p><strong>on_progress</strong> (<em>callable</em><em>, </em><em>optional</em>) – A callback function that receives progress updates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nv200.spibox_device.parse_hex_to_floats_percent">
<span class="sig-name descname"><span class="pre">parse_hex_to_floats_percent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#parse_hex_to_floats_percent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.parse_hex_to_floats_percent" title="Link to this definition"></a></dt>
<dd><p>Parses a string of 4-character hexadecimal values into a float.</p>
<p>The hex values are interpreted as unsigned 16-bit integers and converted to floats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>str</em>) – A string of comma-separated 4-character hex values (e.g., “0000,FFFD,FFFD”).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of float representations of the parsed unsigned integers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nv200.spibox_device.percent_to_hex">
<span class="sig-name descname"><span class="pre">percent_to_hex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/nv200/spibox_device.html#percent_to_hex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nv200.spibox_device.percent_to_hex" title="Link to this definition"></a></dt>
<dd><p>Converts a percentage value (0.0 to 100.0) to a 4-digit hexadecimal string.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="analysis.html" class="btn btn-neutral float-left" title="Resonance Measurement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, piezosystem Jena.
      <span class="lastupdated">Last updated on Jan 19, 2026 08:59.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>